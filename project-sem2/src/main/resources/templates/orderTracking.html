<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<!--<head th:replace="fragments :: html_head">-->
<head>
    <meta charset="utf-8">
    <title>Welcome to Drink World</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link  href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link  href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link  th:href="@{/../css/style.min.css}" rel="stylesheet">
    <link rel="icon" th:href="@{/img/logo1.png}"  type= "img/x-icon">

    <!-- Favicons -->
    <link th:href="@{/../img/favicon.png}"  rel="icon">

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css?family=Open+Sans&display=swap');body{background-color: #eeeeee;font-family: 'Open Sans',serif}.container{margin-top:50px;margin-bottom: 50px}.card{position: relative;display: -webkit-box;display: -ms-flexbox;display: flex;-webkit-box-orient: vertical;-webkit-box-direction: normal;-ms-flex-direction: column;flex-direction: column;min-width: 0;word-wrap: break-word;background-color: #fff;background-clip: border-box;border: 1px solid rgba(0, 0, 0, 0.1);border-radius: 0.10rem}.card-header:first-child{border-radius: calc(0.37rem - 1px) calc(0.37rem - 1px) 0 0}.card-header{padding: 0.75rem 1.25rem;margin-bottom: 0;background-color: #fff;border-bottom: 1px solid rgba(0, 0, 0, 0.1)}.track{position: relative;background-color: #ddd;height: 7px;display: -webkit-box;display: -ms-flexbox;display: flex;margin-bottom: 60px;margin-top: 50px}.track .step{-webkit-box-flex: 1;-ms-flex-positive: 1;flex-grow: 1;width: 25%;margin-top: -18px;text-align: center;position: relative}.track .step.active:before{background: #FF5722}.track .step::before{height: 7px;position: absolute;content: "";width: 100%;left: 0;top: 18px}.track .step.active .icon{background: #ee5435;color: #fff}.track .icon{display: inline-block;width: 40px;height: 40px;line-height: 40px;position: relative;border-radius: 100%;background: #ddd}.track .step.active .text{font-weight: 400;color: #000}.track .text{display: block;margin-top: 7px}.itemside{position: relative;display: -webkit-box;display: -ms-flexbox;display: flex;width: 100%}.itemside .aside{position: relative;-ms-flex-negative: 0;flex-shrink: 0}.img-sm{width: 80px;height: 80px;padding: 7px}ul.row, ul.row-sm{list-style: none;padding: 0}.itemside .info{padding-left: 15px;padding-right: 7px}.itemside .title{display: block;margin-bottom: 5px;color: #212529}p{margin-top: 0;margin-bottom: 1rem}.btn-warning{color: #ffffff;background-color: #ee5435;border-color: #ee5435;border-radius: 1px}.btn-warning:hover{color: #ffffff;background-color: #ff2b00;border-color: #ff2b00;border-radius: 1px}
        .hiden{
            display: none;
        }

        .text-web{
            color: #da9f5b;
        }
        .btn-web{
            background-color: #da9f5b;
        }
    </style>
</head>

<body>
    <div th:replace="fragments :: html_navbar"></div>
    <div class="container-fluid page-header mb-5 position-relative overlay-bottom">
        <div class="d-flex flex-column align-items-center justify-content-center pt-0 pt-lg-5" style="min-height: 400px">
            <h1 class="display-4 mb-3 mt-0 mt-lg-5 text-white text-uppercase"></h1>
            <div class="d-inline-flex mb-lg-5">
                <p class="m-0 text-white"><a class="text-white" href=""></a></p>
                <p class="m-0 text-white px-2"></p>
                <p class="m-0 text-white"></p>
            </div>
        </div>
    </div>
    <div class="container">
        <article class="card">
            <header class="card-header"> <a th:href="@{'/shoppingcard/user/' + ${currentUserId}}">My Orders </a>  <a th:href="@{'/orderTracking/user/'+${currentUserId}}">/ Tracking</a> <a th:href="@{'/historyOrder/user/'+${currentUserId}}">/ History</a></header>
            <div>
                <div class="card-body "th:each="order:${orders}">
                    <input type="hidden" th:value="${order.statusByStatusId.id}" class="statusId">
                    <h6 th:text="'Order ID: '+ ${order.id}"></h6>
                    <article class="card">
                        <div class="card-body row">
                            <strong></strong>
                        </div>
                    </article>
                    <div class="track">
                        <div class="step step1"> <span class="icon"> <i class="fa fa-check"></i> </span> <span class="text">Order confirmed</span> </div>
                        <div class="step step2"> <span class="icon"> <i class="fa fa-user"></i> </span> <span class="text"> Picked by courier</span> </div>
                        <div class="step step3"> <span class="icon"> <i class="fa fa-truck"></i> </span> <span class="text"> On the way </span> </div>
                        <div class="step step4"> <span class="icon"> <i class="fa fa-box"></i> </span> <span class="text">Ready for pickup</span> </div>
                    </div>
                    <hr>
                    <ul class="row" th:each="od: ${order.getOrderDetailsById()}">
                        <li class="col-md-4">
                            <figure class="itemside mb-3">
                                <div class="aside"><img src="https://i.imgur.com/iDwDQ4o.png" th:src="@{'/images/getimage/'+ ${od.productByProductId.image}}" class="img-sm border"></div>
                                <figcaption class="info align-self-center">
                                    <p class="title" th:text="${od.productByProductId.name}"><br></p> <span class="text-muted" th:text="${#numbers.formatDecimal(od.productByProductId.price, 0, 'POINT', 0, 'POINT')} + ' đ'"> </span>
                                </figcaption>
                            </figure>
                        </li>
                    </ul>
                    <hr>
                    <a th:href="@{'/shoppingcard/user/' + ${currentUserId}}" class="btn btn-warning" data-abc="true"> <i class="fa fa-chevron-left"></i> Back to orders</a>
                    <a th:href="@{/updateOrder(orderId=${order.id},userId=${currentUserId})}"  class="btn btn-info received" data-abc="true"></i> Received</a>
                    <hr>
                    <hr>
                </div>

            </div>

        </article>
    </div>
    <div th:replace="fragments :: html_footer"></div>
    <a href="#" class="btn btn-lg btn-web btn-lg-square back-to-top"><i class="fa fa-angle-double-up"></i></a>
    <div th:replace="fragments :: html_cript"></div>
    <script>
        var statusIds = document.querySelectorAll.bind(document)('.statusId')
        const strong = document.getElementsByTagName("strong")
        var step1 = document.querySelectorAll.bind(document)('.step1')
        var step2 = document.querySelectorAll.bind(document)('.step2')
        var step3 = document.querySelectorAll.bind(document)('.step3')
        var step4 = document.querySelectorAll.bind(document)('.step4')
        var receivedBtn = document.querySelectorAll.bind(document)('.received')

        statusIds.forEach((sId,i)=>{
            if(sId.value >= 1){
                step1[i].classList.add('active')
                strong[i].textContent = "Đợi cửa hàng xác nhận"
            }
        })
        statusIds.forEach((sId,i)=>{
            if(sId.value < 6){
                receivedBtn[i].classList.add('hiden')
            }
        })
        statusIds.forEach((sId,i)=>{
            if(sId.value >= 3){
                step1[i].classList.add('active')
                step2[i].classList.add('active')
                strong[i].textContent = "Đơn hàng đã được xác nhận"
            }
        })
        statusIds.forEach((sId,i)=>{
            if(sId.value >= 6){
                step1[i].classList.add('active')
                step2[i].classList.add('active')
                step3[i].classList.add('active')
                step4[i].classList.add('active')
                receivedBtn[i].classList.remove('hiden')
                strong[i].textContent = "Đơn hàng của bạn sẽ được nhận trong khoảng 20 phút nữa"
            }
        })
    </script>
</body>
</html>